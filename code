package javacourseproject;
import java.util.Scanner;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.sql.Statement;
import java.sql.ResultSet;
import java.util.logging.Level;
import java.util.logging.Logger;
class ShoppingMallThread implements Runnable {
shoppingMall shop = new shoppingMall();
int brandName;
int quantity;
public ShoppingMallThread(int brandName,int quantity) {
this.brandName = brandName;
this.quantity=quantity;
}
@Override
public void run() {
shop.calculateprice(brandName,quantity);

}
}
class ShoppingMallThread1 implements Runnable {
shoppingMall1 shop = new shoppingMall1();
int brandName;
int quantity;
public ShoppingMallThread1(int brandName,int quantity) {
this.brandName = brandName;
this.quantity=quantity;
}
@Override
public void run() {
shop.calculateprice(brandName,quantity);

}
}
class ShoppingMallThread2 implements Runnable {
shoppingMall2 shop = new shoppingMall2();
int brandName;
int quantity;
public ShoppingMallThread2(int brandName,int quantity) {
this.brandName = brandName;
this.quantity=quantity;
}
@Override
public void run() {
shop.calculateprice(brandName,quantity);

}
}
class shoppingMall2{
int price=0;
float total=0;
public synchronized void calculateprice( int bname,int quan) {
if (bname==1){
String name;

System.out.println("Enter Name : ");
Scanner z = new Scanner(System.in);
name = z.nextLine();
System.out.println("Enter address : ");
Scanner z1 = new Scanner(System.in);
String addr = z1.nextLine();
price = price + (quan * 4000);
total=total+price;
String b="Name:Footwear Brand name: Adidas Price:4000 Quantity
:"+quan;
System.out.println(b);
System.out.println("Total:"+total);
Connection conn = null;
try{
Class.forName ("com.mysql.jdbc.Driver");
String userName = "root";
String password = "root@123";
String url = "jdbc:mysql://localhost:3306/cp_java";
conn = DriverManager.getConnection (url, userName, password);

Statement stmt = null;
ResultSet rs = null;
try {
stmt = conn.createStatement();
PreparedStatement ps = conn.prepareStatement("INSERT INTO
cp_java.user_info ( name,addr, brand, total) VALUES (?, ?, 'Adidas' ,'" +total+
"')",Statement.RETURN_GENERATED_KEYS);
ps.setString(1, name);
ps.setString(2, addr);
ps.executeUpdate();
ResultSet res = ps.getGeneratedKeys();
System.out.println("Auto-incremented values of the column ID
generated by the current PreparedStatement object: ");
while (res.next()) {
System.out.println(res.getString(1));}
}
catch (Exception ex)
{
System.err.println ("Cannot connect to database server");
ex.printStackTrace();
}
finally
{
if (conn != null)
{
try
{
conn.close ();
System.out.println ("\nDatabase connection terminated...");
}
catch (Exception ex)
{
System.out.println ("Error in connection termination!");

}
}
}
}
catch (ClassNotFoundException ex) {
Logger.getLogger(shoppingMall2.class.getName()).log(Level.SEVERE, null,
ex);
} catch (SQLException ex) {
Logger.getLogger(shoppingMall2.class.getName()).log(Level.SEVERE, null,
ex);
}
}
else
{
String name;
System.out.println("Enter Name : ");
Scanner z = new Scanner(System.in);
name = z.nextLine();

System.out.println("Enter address : ");
Scanner z1 = new Scanner(System.in);
String addr = z1.nextLine();
price = price + (quan * 3600);
total=total+price;
String b="Name:Footwear Brand name: Nike Price:3600 Quantity:
"+quan;
System.out.println(b);
System.out.println("Total:"+total);
Connection conn = null;
try{
Class.forName ("com.mysql.jdbc.Driver");
String userName = "root";
String password = "root@123";
String url = "jdbc:mysql://localhost:3306/cp_java";
conn = DriverManager.getConnection (url, userName, password);
Statement stmt = null;
ResultSet rs = null;
try {
stmt = conn.createStatement();
PreparedStatement ps = conn.prepareStatement("INSERT INTO
cp_java.user_info ( name,addr, brand, total) VALUES (?, ?, 'Nike' ,'" +total+
"')",Statement.RETURN_GENERATED_KEYS);
ps.setString(1, name);
ps.setString(2, addr);
ps.executeUpdate();
ResultSet res = ps.getGeneratedKeys();
System.out.println("Auto-incremented values of the column ID
generated by the current PreparedStatement object: ");
while (res.next()) {
System.out.println(res.getString(1));}
}
catch (Exception ex)
{
System.err.println ("Cannot connect to database server");
ex.printStackTrace();

}
finally
{
if (conn != null)
{
try
{
conn.close ();
System.out.println ("\nDatabase connection terminated...");
}
catch (Exception ex)
{
System.out.println ("Error in connection termination!");

}
}
}
}
catch (ClassNotFoundException ex) {
Logger.getLogger(shoppingMall2.class.getName()).log(Level.SEVERE, null,
ex);
} catch (SQLException ex) {
Logger.getLogger(shoppingMall2.class.getName()).log(Level.SEVERE, null,
ex);
}
}
}
}
class shoppingMall {
int price=0;
float total=0;
public synchronized void calculateprice( int bname,int quan) {
if (bname==1){
String name;
System.out.println("Enter Name : ");

Scanner z = new Scanner(System.in);
name = z.nextLine();
System.out.println("Enter address : ");
Scanner z1 = new Scanner(System.in);
String addr = z1.nextLine();
price = price + (quan * 2999);
total=total+price;
String b="Name:Clothings Brand name: Levis Price:2590 Quantity:
"+quan;
System.out.println(b);
System.out.println("Total:"+total);
Connection conn = null;
try{
Class.forName ("com.mysql.jdbc.Driver");
String userName = "root";
String password = "root@123";
String url = "jdbc:mysql://localhost:3306/cp_java";
conn = DriverManager.getConnection (url, userName, password);
Statement stmt = null;
ResultSet rs = null;
try {
stmt = conn.createStatement();
PreparedStatement ps = conn.prepareStatement("INSERT INTO
cp_java.user_info ( name,addr, brand, total) VALUES (?, ?, 'Levis' ,'" +total+
"')",Statement.RETURN_GENERATED_KEYS);
ps.setString(1, name);
ps.setString(2, addr);
ps.executeUpdate();
ResultSet res = ps.getGeneratedKeys();
System.out.println("Auto-incremented values of the column ID
generated by the current PreparedStatement object: ");
while (res.next()) {
System.out.println(res.getString(1));}
}
catch (Exception ex)
{

System.err.println ("Cannot connect to database server");
ex.printStackTrace();
}
finally
{
if (conn != null)
{
try
{
conn.close ();
System.out.println ("\nDatabase connection terminated...");
}
catch (Exception ex)
{
System.out.println ("Error in connection termination!");

}
}
}
}
catch (ClassNotFoundException ex) {
Logger.getLogger(shoppingMall2.class.getName()).log(Level.SEVERE, null,
ex);
} catch (SQLException ex) {
Logger.getLogger(shoppingMall2.class.getName()).log(Level.SEVERE, null,
ex);
}
}
else{
String name;
String addr;
System.out.println("Enter Name : ");
Scanner z = new Scanner(System.in);
name = z.nextLine();
System.out.println("Enter address : ");
Scanner z1 = new Scanner(System.in);

addr = z1.nextLine();
price = price + (quan * 2499);
total=total+price;
String b="Name:Clothings Brand name: Biba Price:2499 Quantity:
"+quan;
System.out.println(b);
System.out.println("Total:"+total);
Connection conn = null;
try{
Class.forName ("com.mysql.jdbc.Driver");
String userName = "root";
String password = "root@123";
String url = "jdbc:mysql://localhost:3306/cp_java";
conn = DriverManager.getConnection (url, userName, password);
Statement stmt = null;
ResultSet rs = null;
try {
stmt = conn.createStatement();
PreparedStatement ps = conn.prepareStatement("INSERT INTO
cp_java.user_info ( name,addr, brand, total) VALUES (?, ?, 'Biba' ,'" +total+
"')",Statement.RETURN_GENERATED_KEYS);
ps.setString(1, name);
ps.setString(2, addr);
ps.executeUpdate();
ResultSet res = ps.getGeneratedKeys();
System.out.println("Auto-incremented values of the column ID
generated by the current PreparedStatement object: ");
while (res.next()) {
System.out.println(res.getString(1));}
}
catch (Exception ex)
{
System.err.println ("Cannot connect to database server");
ex.printStackTrace();
}
finally
{

if (conn != null)
{
try
{
conn.close ();
System.out.println ("\nDatabase connection terminated...");
}
catch (Exception ex)
{
System.out.println ("Error in connection termination!");
}
}
}
}
catch (ClassNotFoundException ex) {
Logger.getLogger(shoppingMall2.class.getName()).log(Level.SEVERE, null,
ex);
} catch (SQLException ex) {
Logger.getLogger(shoppingMall2.class.getName()).log(Level.SEVERE, null,
ex);
}
}
}
}
class shoppingMall1 {
int price=0;
float total=0;
public synchronized void calculateprice(int bname,int quan) {
if (bname==1){
String name;
System.out.println("Enter Name : ");
Scanner z = new Scanner(System.in);
name = z.nextLine();
System.out.println("Enter address : ");

Scanner z1 = new Scanner(System.in);
String addr = z1.nextLine();
price = price + (quan * 200);
total=total+price;
String b="Name:Cosmetics Brand name: Derma Price:200 Quantity:
"+quan;
System.out.println(b);
System.out.println("Total:"+total);
Connection conn = null;
try{
Class.forName ("com.mysql.jdbc.Driver");
String userName = "root";
String password = "root@123";
String url = "jdbc:mysql://localhost:3306/cp_java";
conn = DriverManager.getConnection (url, userName, password);
Statement stmt = null;
ResultSet rs = null;
try {
stmt = conn.createStatement();
PreparedStatement ps = conn.prepareStatement("INSERT INTO
cp_java.user_info ( name,addr, brand, total) VALUES (?, ?, 'Derma' ,'" +total+
"')",Statement.RETURN_GENERATED_KEYS);
ps.setString(1, name);
ps.setString(2, addr);
ps.executeUpdate();
ResultSet res = ps.getGeneratedKeys();
System.out.println("Auto-incremented values of the column ID
generated by the current PreparedStatement object: ");
while (res.next()) {
System.out.println(res.getString(1));}
}
catch (Exception ex)
{
System.err.println ("Cannot connect to database server");
ex.printStackTrace();
}

finally
{
if (conn != null){
try{
conn.close ();
System.out.println ("\nDatabase connection
terminated...");
}
catch (Exception ex){
System.out.println ("Error in connection termination!");
}
}
}
}
catch (ClassNotFoundException ex) {
Logger.getLogger(shoppingMall2.class.getName()).log(Level.SEVERE, null,
ex);
} catch (SQLException ex) {
Logger.getLogger(shoppingMall2.class.getName()).log(Level.SEVERE, null,
ex);
}
}
else{
int id ;
String name;
System.out.println("Enter Name : ");
Scanner z = new Scanner(System.in);
name = z.nextLine();
System.out.println("Enter address : ");
Scanner z1 = new Scanner(System.in);
String addr = z1.nextLine();
price = price + (quan * 350);
total=total+price;
String b="Name:Cosmetics Brand name: Dove Price:350 Quantity:
"+quan;

System.out.println(b);
System.out.println("Total:"+total);
Connection conn = null;
try{
Class.forName ("com.mysql.jdbc.Driver");
String userName = "root";
String password = "root@123";
String url = "jdbc:mysql://localhost:3306/cp_java";
conn = DriverManager.getConnection (url, userName, password);
Statement stmt = null;
ResultSet rs = null;
try {
stmt = conn.createStatement();
PreparedStatement ps = conn.prepareStatement("INSERT INTO
cp_java.user_info ( name,addr, brand, total) VALUES (?, ?, 'Dove' ,'" +total+
"')",Statement.RETURN_GENERATED_KEYS);
ps.setString(1, name);
ps.setString(2, addr);
ps.executeUpdate();
ResultSet res = ps.getGeneratedKeys();
System.out.println("Auto-incremented values of the column ID
generated by the current PreparedStatement object: ");
while (res.next()) {
System.out.println(res.getString(1));}
}
catch (Exception ex)
{
System.err.println ("Cannot connect to database server");
ex.printStackTrace();
}
finally
{
if (conn != null)
{
try

{
conn.close ();
System.out.println ("\nDatabase connection terminated...");
}
catch (Exception ex)
{
System.out.println ("Error in connection termination!");

}
}
}
}
catch (ClassNotFoundException ex) {
Logger.getLogger(shoppingMall2.class.getName()).log(Level.SEVERE, null,
ex);
} catch (SQLException ex) {
Logger.getLogger(shoppingMall2.class.getName()).log(Level.SEVERE, null,
ex);
}
}
}
}
public class JavaCourseProject {
public static void main(String[] args) {
Scanner in1 = new Scanner(System.in);
String category;
int ch;
System.out.println("---MENU---");
System.out.println("1 Clothing");
System.out.println("2 Cosmetic");
System.out.println("3 Footwear");
System.out.println("4 Search using UserId");
System.out.println("Enter Category: ");
category = in1.nextLine();
ch=category.charAt(0);

switch(ch){
case '1':
Scanner in = new Scanner(System.in);
Scanner in2 = new Scanner(System.in);
System.out.println("Enter brand:");
System.out.println("1 Levis-Rs.2590");
System.out.println("2 Biba-Rs.2499");
int brand= in2.nextInt();
System.out.println("Enter quantity:");
int quan = in.nextInt();
ShoppingMallThread m1;
m1 = new ShoppingMallThread(brand,quan);
Thread t1 = new Thread(m1);
t1.start();
break;
case '2':
Scanner in3 = new Scanner(System.in);
System.out.println("Enter brand:");
System.out.println("1 Derma-Rs.200");
System.out.println("2 Dove-Rs.350");
int brand2= in3.nextInt();
Scanner in4 = new Scanner(System.in);
System.out.println("Enter quantity:");
int quan2 = in4.nextInt();
ShoppingMallThread1 m2;
m2 = new ShoppingMallThread1(brand2,quan2);
Thread t2 = new Thread(m2);
t2.start();
break;
case '3':
Scanner in5 = new Scanner(System.in);
System.out.println("Enter brand:");
System.out.println("1 Adidas-Rs.4000");
System.out.println("2 Nike-Rs.3600");
int brand3= in5.nextInt();
Scanner in6 = new Scanner(System.in);
System.out.println("Enter quantity:");

int quan3 = in6.nextInt();
ShoppingMallThread2 m3;
m3 = new ShoppingMallThread2(brand3,quan3);
Thread t3 = new Thread(m3);
t3.start();
break;
case '4':
Connection conn = null;
try
{
Class.forName ("com.mysql.jdbc.Driver");
String userName = "root";
String password = "root@123";
String url = "jdbc:mysql://localhost:3306/cp_java";
conn = DriverManager.getConnection (url, userName, password);
// Run SQL -> start from here
Statement stmt = null;
stmt = conn.createStatement();
System.out.println("ID: ");
Scanner sc = new Scanner(System.in);
String i = sc.nextLine();
String sql="select * from cp_java.user_info where iduser_info='" +
i + "'";
ResultSet r = stmt.executeQuery(sql);
while(r.next()){
String name_st = r.getString(2);
String addr_st = r.getString(3);
String brand_st = r.getString(4);
float total_st = r.getFloat(5);
System.out.println("Name: " + name_st);
System.out.println("Address: " + addr_st);
System.out.println("Brand: " + brand_st);
System.out.println("Total: " + total_st);

}
}
catch (Exception ex)
{
System.err.println ("Cannot connect to database server");
ex.printStackTrace();
}
finally
{
if (conn != null)
{
try
{
conn.close ();
System.out.println ("\nDatabase connection terminated...");
}
catch (Exception ex)
{
System.out.println ("Error in connection termination!");

}
}
}
break;
}
}
}
